-- CREATE DB
--CREATE DATABASE quanta;

-- CREATE TYPES
CREATE TYPE privacy_level AS ENUM ('public', 'private');
CREATE TYPE status AS ENUM ('pending', 'accepted', 'rejected');
CREATE TYPE recurrence_rule AS ENUM ('daily', 'weekly', 'monthly', 'yearly');
CREATE TYPE event_role AS ENUM ('host', 'member');


-- DONE
CREATE TABLE db_category(
    category_id SERIAL PRIMARY KEY,
    category_name varchar(45) UNIQUE,
    category_description varchar(255) NULL
);


-- DONE
CREATE TABLE db_user(
    user_id SERIAL PRIMARY KEY,
    username varchar(45) NOT NULL,
    email varchar(60) NOT NULL,
    password_hash varchar(255) NOT NULL,
    birthday date NOT NULL,
    created_at timestamp NOT NULL,
    last_login timestamp NOT NULL,
    update_date timestamp NOT NULL,
    is_active boolean NOT NULL
);
ALTER TABLE db_user ADD UNIQUE(username, email);

-- DONE
CREATE TABLE db_event(
    event_id SERIAL PRIMARY KEY,
    created_by int NOT NULL REFERENCES db_user(user_id),
    event_name varchar(60) NOT NULL,
    event_description varchar(255) NULL,
    event_date_start timestamp not NULL,
    event_date_end timestamp NOT NULL,
    event_location varchar(255) NULL,
    privacy privacy_level NOT NULL,
	recurrence recurrence_rule NOT NULL,
	next_event_date timestamp NULL
);


-- DONE
CREATE TABLE db_event_category(
    event_id int NOT NULL,
    category_id int NOT NULL,
    PRIMARY KEY(event_id, category_id),

    CONSTRAINT fk_event_id FOREIGN KEY(event_id) REFERENCES db_event(event_id),
    CONSTRAINT fk_category_id FOREIGN KEY(category_id) REFERENCES db_category(category_id)
);


-- DONE
CREATE TABLE db_user_friendship(
    friendship_id SERIAL PRIMARY KEY,
    user1_id int NOT NULL,
    user2_id int NOT NULL,
    friendship_status status NOT NULL,
    sent_at timestamp NOT NULL,
    action_time timestamp NULL,

    CONSTRAINT fk_user1_id FOREIGN KEY(user1_id) REFERENCES db_user(user_id),
    CONSTRAINT fk_user2_id FOREIGN KEY(user2_id) REFERENCES db_user(user_id)
);

-- DONE
CREATE TABLE db_event_participants (
    event_id INT,
    user_id INT,
    participant_status status NOT NULL,
    participant_role event_role NOT NULL,
    response_time timestamp NOT NULL,

	PRIMARY KEY (event_id, user_id),
    CONSTRAINT fk_event_for_participants FOREIGN KEY (event_id) REFERENCES db_event(event_id),
    CONSTRAINT fk_participants_for_events FOREIGN KEY (user_id) REFERENCES db_user(user_id)
);

--I'm not sure is this right
CREATE SEQUENCE db_event_id_seq START 1;
CREATE SEQUENCE db_category_id_seq START 1;


-- DATA GENERATED BY CHAT GPT-4

INSERT INTO db_user (username, email, password_hash, birthday, created_at, last_login, update_date, is_active) VALUES
('johndoe', 'johndoe@example.com', '5f4dcc3b5aa765d61d8327deb882cf99', '1990-01-01', '2023-03-25 12:00:00', '2023-03-25 15:00:00', '2023-03-25 15:00:00', true),
('janedoe', 'janedoe@example.com', '7c6a180b36896a0a8c02787eeafb0e4c', '1992-05-15', '2023-03-24 09:30:00', '2023-03-25 14:45:00', '2023-03-25 14:45:00', true),
('aliceblue', 'alice@example.com', 'e99a18c428cb38d5f260853678922e03', '1995-07-30', '2023-03-20 08:20:00', '2023-03-25 16:30:00', '2023-03-25 16:30:00', true),
('bobbuilder', 'bob@example.com', '878ef96e86145580c38c87f0410ad153', '1988-11-24', '2023-03-22 07:15:00', '2023-03-25 17:00:00', '2023-03-25 17:00:00', false),
('mikestone', 'mike@example.com', '1a1dc91c907325c69271ddf0c944bc72', '1985-09-15', '2023-03-26 10:00:00', '2023-03-26 12:00:00', '2023-03-26 12:00:00', true),
('sarahgreen', 'sarah@example.com', 'b6d767d2f8ed5d21a44b0e5886680cb9', '1993-02-20', '2023-03-26 09:00:00', '2023-03-26 11:30:00', '2023-03-26 11:30:00', false),
('lucasgrey', 'lucas@example.com', '37693cfc748049e45d87b8c7d8b9aacd', '1989-07-31', '2023-03-26 08:45:00', '2023-03-26 10:30:00', '2023-03-26 10:30:00', true),
('emilyrose', 'emily@example.com', '4a8a08f09d37b73795649038408b5f33', '1994-12-08', '2023-03-26 07:30:00', '2023-03-26 09:20:00', '2023-03-26 09:20:00', true),
('davidcool', 'david@example.com', '02e74f10e0327ad868d138f2b4fdd6f0', '1990-04-18', '2023-03-26 11:15:00', '2023-03-26 13:10:00', '2023-03-26 13:10:00', true),
('lisasmith', 'lisa@example.com', '70efdf2ec9b086079795c442636b55fb', '1986-11-24', '2023-03-26 12:20:00', '2023-03-26 14:25:00', '2023-03-26 14:25:00', true),
('kevinrock', 'kevin@example.com', '33e75ff09dd601bbe69f351039152189', '1992-08-03', '2023-03-26 10:35:00', '2023-03-26 12:40:00', '2023-03-26 12:40:00', true),
('angelawhite', 'angela@example.com', '6ea9ab1baa0efb9e19094440c317e21b', '1991-05-19', '2023-03-26 08:50:00', '2023-03-26 11:00:00', '2023-03-26 11:00:00', false),
('tonystark', 'tony@example.com', '8f14e45fceea167a5a36dedd4bea2543', '1995-03-28', '2023-03-26 07:00:00', '2023-03-26 09:15:00', '2023-03-26 09:15:00', true),
('natalieport', 'natalie@example.com', 'c81e728d9d4c2f636f067f89cc14862c', '1987-07-07', '2023-03-26 09:40:00', '2023-03-26 12:05:00', '2023-03-26 12:05:00', true);


INSERT INTO db_category (category_name, category_description) VALUES
('Sports', 'All sports related events'),
('Music', 'Concerts, music festivals, and musical gatherings'),
('Education', 'Educational events including workshops, seminars, and webinars'),
('Networking', 'Events for professionals to network and connect'),
('Technology', 'Tech-related events including hackathons, product launches, and tech talks'),
('Art', 'Art exhibitions, craft fairs, and live art events'),
('Food & Drink', 'Food festivals, wine tastings, and culinary events'),
('Health & Wellness', 'Wellness retreats, yoga sessions, and health workshops'),
('Travel & Outdoor', 'Outdoor adventures, travel meetups, and nature walks'),
('Community', 'Local community events, charity fundraisers, and social gatherings');


INSERT INTO db_event (created_by, event_name, event_description, event_date_start, event_date_end, event_location, privacy, recurrence, next_event_date) VALUES
(1, 'Hackathon 2024', 'Annual coding competition with participants worldwide.', '2024-04-15 09:00:00', '2024-04-17 18:00:00', 'Tech Park, Silicon Valley', 'public', 'yearly', '2025-04-15 09:00:00'),
(2, 'Jazz Night', 'Enjoy an evening of live jazz music with renowned musicians.', '2024-05-20 19:00:00', '2024-05-20 23:00:00', 'Downtown Jazz Bar, New York', 'public', 'monthly', '2024-06-20 19:00:00'),
(3, 'Startup Pitch Event', 'Local startups pitch to investors for funding opportunities.', '2024-06-10 10:00:00', '2024-06-10 16:00:00', 'Innovation Hub, Boston', 'private', 'monthly', '2024-07-10 10:00:00'),
(4, 'Marathon 2024', 'Citywide marathon for charity, open for all age groups.', '2024-07-05 06:00:00', '2024-07-05 12:00:00', 'City Park, Chicago', 'public', 'yearly', '2025-07-05 06:00:00'),
(5, 'Blockchain Conference', 'Discuss the future of blockchain technology and its applications.', '2024-08-25 09:00:00', '2024-08-27 17:00:00', 'Conference Center, San Francisco', 'private', 'yearly', '2025-08-25 09:00:00'),
(6, 'Wine Tasting Event', 'Explore fine wines from around the globe with expert sommeliers.', '2024-09-15 15:00:00', '2024-09-15 20:00:00', 'Vineyard Estate, Napa Valley', 'public', 'monthly', '2024-10-15 15:00:00'),
(7, 'Digital Marketing Workshop', 'Learn the latest in digital marketing from industry leaders.', '2024-10-10 09:00:00', '2024-10-12 17:00:00', 'Tech Co-Working Space, Austin', 'public', 'yearly', '2025-10-10 09:00:00'),
(8, 'Yoga Retreat', 'A weekend of yoga, meditation, and wellness.', '2024-11-20 08:00:00', '2024-11-22 17:00:00', 'Mountain Retreat, Colorado', 'private', 'yearly', '2025-11-20 08:00:00'),
(9, 'Film Festival', 'Showcasing independent films from emerging filmmakers.', '2024-12-05 10:00:00', '2024-12-10 22:00:00', 'Downtown Cinema, Los Angeles', 'public', 'yearly', '2025-12-05 10:00:00'),
(10, 'Tech Meetup', 'Monthly meetup for tech enthusiasts to share ideas and network.', '2024-01-15 18:00:00', '2024-01-15 21:00:00', 'Tech Cafe, Seattle', 'public', 'monthly', '2024-02-15 18:00:00');


INSERT INTO db_event_category (event_id, category_id) VALUES
(1, 5), -- Hackathon 2024 is a Technology event
(2, 2), -- Jazz Night is a Music event
(3, 4), -- Startup Pitch Event is a Networking event
(4, 1), -- Marathon 2024 is a Sports event
(5, 5), -- Blockchain Conference is a Technology event
(6, 7), -- Wine Tasting Event is a Food & Drink event
(7, 3), -- Digital Marketing Workshop is an Education event
(8, 8), -- Yoga Retreat is a Health & Wellness event
(9, 6), -- Film Festival is an Art event
(10, 5); -- Tech Meetup is a Technology event


INSERT INTO db_user_friendship (user1_id, user2_id, friendship_status, sent_at, action_time) VALUES
(1, 2, 'accepted', '2024-01-01 08:00:00', '2024-01-02 09:00:00'),
(1, 3, 'rejected', '2024-01-03 08:00:00', '2024-01-04 09:00:00'),
(1, 4, 'pending', '2024-01-05 08:00:00', NULL),
(2, 3, 'accepted', '2024-01-06 08:00:00', '2024-01-07 09:00:00'),
(2, 5, 'rejected', '2024-01-08 08:00:00', '2024-01-09 09:00:00'),
(3, 6, 'accepted', '2024-01-10 08:00:00', '2024-01-11 09:00:00'),
(4, 7, 'pending', '2024-01-12 08:00:00', NULL),
(5, 8, 'accepted', '2024-01-13 08:00:00', '2024-01-14 09:00:00'),
(6, 9, 'accepted', '2024-01-15 08:00:00', '2024-01-16 09:00:00'),
(7, 10, 'rejected', '2024-01-17 08:00:00', '2024-01-18 09:00:00'),
(8, 10, 'pending', '2024-01-19 08:00:00', NULL),
(9, 2, 'accepted', '2024-01-20 08:00:00', '2024-01-21 09:00:00'),
(10, 1, 'rejected', '2024-01-22 08:00:00', '2024-01-23 09:00:00');



INSERT INTO db_event_participants (event_id, user_id, participant_status, participant_role, response_time) VALUES
(1, 1, 'accepted', 'host', '2024-04-14 09:00:00'),
(1, 2, 'accepted', 'member', '2024-04-14 09:15:00'),
(1, 3, 'pending', 'member', '2024-04-14 09:30:00'),
(2, 4, 'accepted', 'host', '2024-05-19 19:00:00'),
(2, 5, 'accepted', 'member', '2024-05-19 19:20:00'),
(2, 6, 'accepted', 'member', '2024-05-19 19:25:00'),
(3, 7, 'accepted', 'host', '2024-06-09 10:00:00'),
(3, 8, 'pending', 'member', '2024-06-09 10:30:00'),
(4, 2, 'accepted', 'host', '2024-07-04 06:00:00'),
(4, 1, 'accepted', 'member', '2024-07-04 06:15:00'),
(5, 9, 'accepted', 'host', '2024-08-24 09:00:00'),
(5, 10, 'accepted', 'member', '2024-08-24 09:10:00'),
(6, 3, 'accepted', 'host', '2024-09-14 15:00:00'),
(6, 4, 'accepted', 'member', '2024-09-14 15:20:00'),
(7, 5, 'accepted', 'host', '2024-10-09 09:00:00'),
(7, 6, 'accepted', 'member', '2024-10-09 09:15:00'),
(8, 7, 'accepted', 'host', '2024-11-19 08:00:00'),
(8, 8, 'accepted', 'member', '2024-11-19 08:10:00'),
(9, 9, 'accepted', 'host', '2024-12-04 10:00:00'),
(9, 1, 'accepted', 'member', '2024-12-04 10:20:00'),
(10, 10, 'accepted', 'host', '2024-01-14 18:00:00'),
(10, 2, 'accepted', 'member', '2024-01-14 18:10:00');


